<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="noindex" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <title>Content Manager</title>

    <script>
      var para = new URLSearchParams(window.location.search);
      const ACCOUNT_NAME = para.get("acc_name");
      const REPO_NAME = para.get("repo");
      let CMS_CONFIG = {
        backend: {
          name: "github",
          repo: `${ACCOUNT_NAME}/${REPO_NAME}`,
          branch: "master",
        },
        media_folder: "experiment/images",
        // load_config_file: false
        collections: [
          {
            name: "Experiment",
            label: REPO_NAME,
            folder: "/experiment",
            create: false,
            slug: "experiment",
            delete: false,
            fields: [
              { name: "title", label: "Title", widget: "string" },
              { name: "body", label: "Body", widget: "markdown" },
            ],
          },
        ],
      };
    </script>
  </head>
  <body>
    <style>
      #myBtn {
        position: fixed;
        bottom: 20px;
        right: 30px;
        z-index: 99;
        font-size: 18px;
        border: none;
        outline: none;
        background-color: #b2b7c5;
        color: white;
        cursor: pointer;
        padding: 10px;
        border-radius: 4px;
      }

      #myBtn:hover {
        background-color: #555;
      }

      .user_name {
        font-size: 18px;
        color: #2d3e3f;
        height: inherit;
        margin-top: 10px;
      }
    </style>
    <script>
      function back_to_home() {
        window.location.href = `/`;
      }
    </script>
    <button id="myBtn" title="Back to Home" onclick="back_to_home()">
      <i class="fa fa-home" style="font-size: 48px; color: white"></i>
    </button>
    <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>
    <script>
      CMS.init({ config: CMS_CONFIG });
    </script>

    <script>
      let user_name = JSON.parse(
        localStorage.getItem("netlify-cms-user")
      ).login;
      var targetNode = document.body;
      var observer = new MutationObserver(function (mutationsList, observer) {
        var parentDiv = document.querySelector('[class*="AppHeaderContent"]');
        if (parentDiv) {
          observer.disconnect();
          var newDiv = document.createElement("span");
          newDiv.className = "user_name";
          newDiv.innerHTML = `${user_name}`;
          var navTag = parentDiv.querySelector("img");
          if (navTag) {
            navTag.insertAdjacentElement("beforebegin", newDiv);
          } else {
            parentDiv.appendChild(newDiv);
          }
        }
      });
      observer.observe(targetNode, { childList: true, subtree: true });
    </script>
  </body>
</html>
